document.addEventListener('DOMContentLoaded',function(){
    const initMobileMenu=()=>{
        const e=document.querySelector('.burger-menu'),t=document.querySelector('.nav-menu');
        if(!e||!t)return;
        e.addEventListener('click',t=>{t.stopPropagation(),e.classList.toggle('active'),t.classList.toggle('active'),
        document.body.style.overflow=t.classList.contains('active')?'hidden':'auto',
        e.setAttribute('aria-expanded',e.classList.contains('active'))}),
        document.addEventListener('click',t=>{!t.target.closest('.navbar')&&t.classList.contains('active')&&
        (e.classList.remove('active'),t.classList.remove('active'),
        document.body.style.overflow='auto',e.setAttribute('aria-expanded','false'))}),
        document.addEventListener('keydown',t=>{'Escape'===t.key&&t.classList.contains('active')&&
        (e.classList.remove('active'),t.classList.remove('active'),
        document.body.style.overflow='auto',e.setAttribute('aria-expanded','false'))})
    },initHeaderScroll=()=>{
        const e=document.querySelector('.header');
        if(!e)return;
        let t=0,o=!1;
        window.addEventListener('scroll',()=>{
            const n=window.pageYOffset||document.documentElement.scrollTop;
            o||(window.requestAnimationFrame(()=>{
                n>50?e.classList.add('scrolled'):e.classList.remove('scrolled'),
                n>t&&n>100?e.style.transform='translateY(-100%)':e.style.transform='translateY(0)',
                t=n,o=!1
            }),o=!0)
        })
    };
    class CinematicHeroSlider{
        constructor(){
            this.slides=document.querySelectorAll('.slide'),this.indicators=document.querySelectorAll('.indicator'),
            this.prevBtn=document.querySelector('.slider-prev'),this.nextBtn=document.querySelector('.slider-next'),
            this.currentSlide=0,this.totalSlides=this.slides.length,this.autoPlayInterval=null,this.autoPlayDelay=7e3,
            this.slides.length>0&&this.init()
        }
        init(){
            this.showSlide(this.currentSlide),this.prevBtn&&this.prevBtn.addEventListener('click',()=>this.prevSlide()),
            this.nextBtn&&this.nextBtn.addEventListener('click',()=>this.nextSlide()),
            this.indicators.forEach((e,t)=>{e.addEventListener('click',()=>this.goToSlide(t))}),
            this.slides.forEach(e=>{
                e.addEventListener('mouseenter',()=>this.stopAutoPlay()),
                e.addEventListener('mouseleave',()=>this.startAutoPlay())
            }),this.startAutoPlay()
        }
        showSlide(e){
            this.slides.forEach(t=>t.classList.remove('active')),
            this.indicators.forEach(t=>{t.classList.remove('active'),t.setAttribute('aria-selected','false')}),
            this.slides[e]&&this.slides[e].classList.add('active'),
            this.indicators[e]&&(this.indicators[e].classList.add('active'),this.indicators[e].setAttribute('aria-selected','true')),
            this.currentSlide=e
        }
        nextSlide(){
            const e=(this.currentSlide+1)%this.totalSlides;
            this.showSlide(e),this.resetAutoPlay()
        }
        prevSlide(){
            const e=(this.currentSlide-1+this.totalSlides)%this.totalSlides;
            this.showSlide(e),this.resetAutoPlay()
        }
        goToSlide(e){e>=0&&e<this.totalSlides&&(this.showSlide(e),this.resetAutoPlay())}
        startAutoPlay(){this.totalSlides>1&&window.innerWidth>768&&(this.autoPlayInterval=setInterval(()=>this.nextSlide(),this.autoPlayDelay))}
        stopAutoPlay(){clearInterval(this.autoPlayInterval)}
        resetAutoPlay(){this.stopAutoPlay(),this.startAutoPlay()}
    }
    class TestimonialsSlider{
        constructor(){
            this.slides=document.querySelectorAll('.testimonial-slide'),this.dots=document.querySelectorAll('.testimonial-dot'),
            this.prevBtn=document.querySelector('.testimonial-prev'),this.nextBtn=document.querySelector('.testimonial-next'),
            this.currentSlide=0,this.slides.length>0&&this.init()
        }
        init(){
            this.showSlide(this.currentSlide),this.prevBtn&&this.prevBtn.addEventListener('click',()=>this.prevSlide()),
            this.nextBtn&&this.nextBtn.addEventListener('click',()=>this.nextSlide()),
            this.dots.forEach((e,t)=>{e.addEventListener('click',()=>this.goToSlide(t))}),
            this.slides.length>1&&window.innerWidth>768&&setInterval(()=>this.nextSlide(),8e3)
        }
        showSlide(e){
            this.slides.forEach(t=>t.classList.remove('active')),
            this.dots.forEach(t=>t.classList.remove('active')),
            this.slides[e]&&this.slides[e].classList.add('active'),
            this.dots[e]&&this.dots[e].classList.add('active'),
            this.currentSlide=e
        }
        nextSlide(){
            const e=(this.currentSlide+1)%this.slides.length;
            this.showSlide(e)
        }
        prevSlide(){
            const e=(this.currentSlide-1+this.slides.length)%this.slides.length;
            this.showSlide(e)
        }
        goToSlide(e){e>=0&&e<this.slides.length&&this.showSlide(e)}
    }
    class FAQAccordion{
        constructor(){
            this.faqItems=document.querySelectorAll('.faq-item'),this.faqItems.length>0&&this.init()
        }
        init(){
            this.faqItems.forEach(e=>{
                const t=e.querySelector('.faq-question');
                t.addEventListener('click',()=>{this.toggleItem(e)}),
                t.addEventListener('keydown',t=>{('Enter'===t.key||' '===t.key)&&(t.preventDefault(),this.toggleItem(e))})
            })
        }
        toggleItem(e){
            this.faqItems.forEach(t=>{t!==e&&t.classList.contains('active')&&t.classList.remove('active')}),
            e.classList.toggle('active')
        }
    }
    class ContactForm{
        constructor(){
            this.form=document.getElementById('consultationForm'),this.statusEl=document.getElementById('formStatus'),
            this.form&&this.init()
        }
        init(){
            this.form.addEventListener('submit',async e=>{
                if(e.preventDefault(),!this.validateForm())return;
                const t=new FormData(this.form),n={name:t.get('name'),contact:t.get('contact'),format:t.get('format'),message:t.get('message'),date:new Date().toISOString()};
                this.showStatus('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞—è–≤–∫—É...','loading');
                try{
                    await this._sendToTelegram(n),
                    await this.simulateApiCall(),
                    this.showStatus('–°–ø–∞—Å–∏–±–æ! –ú—ã –ø–æ–ª—É—á–∏–ª–∏ –≤–∞—à—É –∑–∞—è–≤–∫—É –∏ —Å–∫–æ—Ä–æ —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏.','success'),
                    setTimeout(()=>{this.form.reset(),this.clearStatus()},5e3)
                }catch(e){
                    console.error('Form submission error:',e),
                    this.showStatus('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –Ω–∞–ø—Ä—è–º—É—é.','error')
                }
            })
        }
        async _sendToTelegram(e){
            const t='8402206062:AAEJim1GkriKqY_o1mOo0YWSWQDdw5Qy2h0',
            n='-1002313355102',
            o=`https://api.telegram.org/bot${t}/sendMessage`,
            a=this._getFormatName(e.format),
            r=`\nüÜï <b>–ù–û–í–ê–Ø –ó–ê–Ø–í–ö–ê –° –°–ê–ô–¢–ê "–¢–ï–†–†–ò–¢–û–†–ò–Ø –õ–Æ–ë–í–ò"</b>\n\n<b>üë§ –ò–ú–Ø:</b>\n${e.name}\n\n<b>üìû –ö–û–ù–¢–ê–ö–¢:</b>\n${e.contact}\n\n<b>üéØ –§–û–†–ú–ê–¢:</b>\n${a}\n\n<b>üí¨ –°–û–û–ë–©–ï–ù–ò–ï:</b>\n${e.message||'‚Äî –Ω–µ —É–∫–∞–∑–∞–Ω–æ ‚Äî'}\n`.trim(),
            i={chat_id:n,text:r,parse_mode:'HTML'};
            const s=await fetch(o,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(i)}),
            d=await s.json();
            return d.ok||console.warn('Telegram API Warning:',d.description),d
        }
        _getFormatName(e){
            const t={individual:'–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —Å–µ—Å—Å–∏—è',circle:'–ñ–µ–Ω—Å–∫–∏–π –∫—Ä—É–≥',levels:'–£—Ä–æ–≤–µ–Ω—å –ø–æ–≥—Ä—É–∂–µ–Ω–∏—è',not_sure:'–ü–æ–∫–∞ –Ω–µ –∑–Ω–∞—é, –Ω—É–∂–Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è'};
            return t[e]||e
        }
        validateForm(){
            const e=this.form.querySelector('#name'),t=this.form.querySelector('#contact'),n=this.form.querySelector('#consent');
            let o=!0;
            return this.clearErrors(),e.value.trim()||(this.showError(e,'–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è'),o=!1),
            t.value.trim()||(this.showError(t,'–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ'),o=!1),
            n.checked||(this.showError(n.parentElement,'–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö'),o=!1),o
        }
        showError(e,t){
            e.classList.add('error');
            const n=document.createElement('div');
            n.className='error-message',n.textContent=t,n.style.cssText='color:#F44336;font-size:14px;margin-top:8px;font-weight:500;',
            e.parentElement.appendChild(n)
        }
        clearErrors(){
            this.form.querySelectorAll('.error').forEach(e=>e.classList.remove('error')),
            this.form.querySelectorAll('.error-message').forEach(e=>e.remove())
        }
        showStatus(e,t='info'){
            this.statusEl&&(this.statusEl.textContent=e,this.statusEl.className='form-status',this.statusEl.classList.add(t))
        }
        clearStatus(){this.statusEl&&(this.statusEl.textContent='',this.statusEl.className='form-status')}
        async simulateApiCall(){return new Promise(e=>{setTimeout(e,1500)})}
    }
    class SmoothScroll{
        constructor(){this.init()}
        init(){
            document.addEventListener('click',e=>{
                const t=e.target.closest('a[href^="#"]');
                if(!t)return;
                const n=t.getAttribute('href');
                if('#'===n||'#0'===n)return;
                const o=document.querySelector(n);
                if(o&&(e.preventDefault(),
                document.querySelector('.burger-menu')&&document.querySelector('.nav-menu')&&
                document.querySelector('.nav-menu').classList.contains('active')&&
                (document.querySelector('.burger-menu').classList.remove('active'),
                document.querySelector('.nav-menu').classList.remove('active'),
                document.body.style.overflow='auto',
                document.querySelector('.burger-menu').setAttribute('aria-expanded','false')),
                o.scrollIntoView({behavior:'smooth',block:'start'})))
            })
        }
    }
    class MobileOptimization{
        constructor(){this.init()}
        init(){
            'ontouchstart'in window||navigator.maxTouchPoints>0&&document.body.classList.add('touch-device'),
            this.optimizeImages(),this.preventZoomOnInput()
        }
        optimizeImages(){
            document.querySelectorAll('img').forEach(e=>{e.hasAttribute('loading')||e.setAttribute('loading','lazy')})
        }
        preventZoomOnInput(){
            window.innerWidth<=768&&document.querySelectorAll('input, textarea, select').forEach(e=>{
                e.addEventListener('focus',()=>{
                    setTimeout(()=>{
                        window.scrollTo({top:e.getBoundingClientRect().top+window.pageYOffset-100,behavior:'smooth'})
                    },100)
                })
            })
        }
    }
    initMobileMenu(),initHeaderScroll(),new CinematicHeroSlider(),new TestimonialsSlider(),new FAQAccordion(),new ContactForm(),new SmoothScroll(),new MobileOptimization();
    const yearSpan=document.querySelector('#currentYear');
    yearSpan&&(yearSpan.textContent=new Date().getFullYear());
    let resizeTimeout;
    window.addEventListener('resize',()=>{
        clearTimeout(resizeTimeout),
        resizeTimeout=setTimeout(()=>{
            window.innerWidth<=768?document.body.classList.add('mobile-view'):document.body.classList.remove('mobile-view')
        },250)
    })
});
